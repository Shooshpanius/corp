
<%
    int_numbers = @form_data[:int_numbers]
    int_numbers.each do |int_num|

    n_alias = CorpNumber.where('address_book_corp_id	= ? and type_n = ?', int_num.address_book_corp_id, 'a')
    n_corp = CorpNumber.where('address_book_corp_id	= ? and type_n = ?', int_num.address_book_corp_id, 'c')
    n_mobile = CorpNumber.where('address_book_corp_id	= ? and type_n = ?', int_num.address_book_corp_id, 'm')
    n_home = CorpNumber.where('address_book_corp_id	= ? and type_n = ?', int_num.address_book_corp_id, 'h')
%>
exten => <%= int_num.number %>,1,MixMonitor(${UNIQUEID}.wav,,/etc/asterisk/vlk.scripts/rec.sh ${UNIQUEID})
<%
    if n_alias.size == 1
%>
exten => <%= int_num.number %>,2,Dial(<%= n_alias[0].number %>,15)
<%
    else
%>
exten => <%= int_num.number %>,2,Dial(<%= int_num.number %>,15)
<% end %>
<% if n_corp.size == 1     %>
exten => <%= int_num.number %>,3,Dial(${ZEBRA_DOK}/01#8<%= n_corp[0].number %>,15,L(1800000))
<% end %>
<% if n_mobile.size == 1 %>
exten => <%= int_num.number %>,4,Dial(${ZEBRA_DOK}/01#8<%= n_mobile[0].number %>,15,L(1800000))
<% end %>
<% if n_home.size == 1     %>
exten => <%= int_num.number %>,4,Dial(${ZEBRA_DOK}/01#8<%= n_home[0].number %>,15,L(1800000))
<% end %>
exten => <%= int_num.number %>,n,Hangup()

<% end %>